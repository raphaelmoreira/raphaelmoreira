{
  "README.html": {
    "href": "README.html",
    "title": "Gest√£o do website | por Raphael Moreira",
    "keywords": "Gest√£o do website Conte√∫do gerado atrav√©s da ferramenta DocFx. Passos Criando e executando um novo projeto de documenta√ß√£o. dotnet tool install docfx --global dotnet tool update -g docfx mkdir tool cd tool mkdir docfx_project cd docfx_project docfx init docfx tool/docfx_project/docfx.json --serve Edite o toc.yml na raiz para produzir os menus principais (superiores) Efetue o commit para o resposit√≥rio No reposit√≥rio, clique no menu Settings Na se√ß√£o Code and automation, clique em Pages Em Build and deployment, selecione a fonte GitHub Actions Na op√ß√£o que abriu, opte por Static HTML e clique em Configure Atualize name e jobs:deploy:steps:name(Upload artifact):with:path:(./doc/site) ou o caminho conforme sua estrutura. Efetue o commit e verifique se est√° de acordo."
  },
  "aegis/divulgacao/microsoft/en-us/vulnerabilidade-enumeracao-usuarios-loginmicrosoftonline.html": {
    "href": "aegis/divulgacao/microsoft/en-us/vulnerabilidade-enumeracao-usuarios-loginmicrosoftonline.html",
    "title": "Vulnerability Disclosure: User Enumeration in Microsoft Online Authentication Service | por Raphael Moreira",
    "keywords": "Vulnerability Disclosure: User Enumeration in Microsoft Online Authentication Service Data da publica√ß√£o: 11/05/2024 05:35PM üáßüá∑ | üá∫üá∏ Introduction This document aims to describe the user enumeration vulnerability discovered in Microsoft Online authentication, which can be exploited both visually and programmatically in any application that integrates with the service. Exploitation The attack vector stems from both the observation of the behavior of return messages (visual) and the structure of the response from the respective endpoint (programmatic). Requirements Although the vulnerability is in the Microsoft Online authentication service, the following steps aim to demonstrate the exploitation briefly, in a controlled and secure environment, simulating the integration of the fictitious application my-app.com. Access the Azure AD (Microsoft Entra ID) portal and register a new application through App Registration; Choose the Access Token method; Grant the email and User.Read permissions via Microsoft Graph. After registration, we obtain - among other values omitted for brevity - the appId parameter, used in constructing the url that will redirect from my-app.com to login.microsoftonline.com, where authentication will occur: https://login.microsoftonline.com/{appId}/oauth2/v2.0/authorize We should also include the clientId and code parameters, obtained during the backend flow of my-app.com: ?client_id={clientId}&response_type=code&code_challenge={code} Finally, we complete with the fixed parameters: &code_challenge_method=S256 &redirect_uri=https://my-app.com/success &scope=https://graph.microsoft.com/email &prompt=select_account &sso_reload=true In the final set, the url to be used by my-app.com will be: https://login.microsoftonline.com/{appId}/oauth2/v2.0/authorize?client_id={clientId}&response_type=code&code_challenge={code}&code_challenge_method=S256&redirect_uri=https://my-app.com/success&scope=https://graph.microsoft.com/email&prompt=select_account&sso_reload=true Visual Methodology The url will take you to the application's authentication service (appId), customized for the requesting tenant (clientId), which will require access credentials. From the analysis of the response pattern, it is possible to determine if the user exists or not. Initial screen Enter invalid data Service confirms Correct domain, the message changes Correct user, password is requested Programmatic Methodology By inspecting the source code of the login.microsoftonline.com service and analyzing the network packets sent, we found the GetCredentialType endpoint. Extracting the request body, we obtain: curl --location 'https://login.microsoftonline.com/common/GetCredentialType?mkt=pt-BR' \\ --header 'accept: application/json' \\ --header 'accept-language: pt-BR,pt;q=0.7' \\ --header 'canary: {canaryHash}' \\ --header 'client-request-id: {requestGuid}' \\ --header 'content-type: application/json; charset=UTF-8' \\ --header 'cookie: brcap=0; ESTSSSOTILES=1; AADSSOTILES=1; x-ms-gateway-slice=estsfd; stsservicecookie=estsfd; AADSSO=NA|NoExtension; ESTSAUTHLIGHT=+58498593-a7a2-422b-84bd-ef0fb1c85b0d; CCState={cstateHash}' \\ --header 'hpgact: 1800' \\ --header 'hpgid: 1104' \\ --header 'hpgrequestid: {hpgRequestGuid}' \\ --header 'origin: https://login.microsoftonline.com' \\ --header 'priority: u=1, i' \\ --header 'referer: https://login.microsoftonline.com/{appId}/oauth2/v2.0/authorize?client_id={clientId}&response_type=code&code_challenge={code}&code_challenge_method=S256&redirect_uri=https://my-app.com/success&scope=https://graph.microsoft.com/email&prompt=select_account&sso_reload=true --header 'sec-ch-ua: \"Brave\";v=\"125\", \"Chromium\";v=\"125\", \"Not.A/Brand\";v=\"24\"' \\ --header 'sec-ch-ua-mobile: ?0' \\ --header 'sec-ch-ua-platform: \"Windows\"' \\ --header 'sec-fetch-dest: empty' \\ --header 'sec-fetch-mode: cors' \\ --header 'sec-fetch-site: same-origin' \\ --header 'sec-gpc: 1' \\ --header 'user-agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/125.0.0.0 Safari/537.36' \\ --data-raw '{\"username\":\"abacate@avocado.com.br\",\"isOtherIdpSupported\":true,\"checkPhones\":false,\"isRemoteNGCSupported\":true,\"isCookieBannerShown\":false,\"isFidoSupported\":true,\"originalRequest\":\"{originalRequestHash}\",\"country\":\"BR\",\"forceotclogin\":false,\"isExternalFederationDisallowed\":false,\"isRemoteConnectSupported\":false,\"federationFlags\":0,\"isSignup\":false,\"flowToken\":\"{flowToken}\",\"isAccessPassSupported\":true}' Although the set of headers and parameters is extensive, suggesting secure handling regarding sending or origin, nothing is actually done with requestGuid, cstateHash, hpgRequestGuid, originalRequestHash, or flowToken. Considering that there is no verification or consistency of the object regarding its manipulation, we can remove them: curl --location 'https://login.microsoftonline.com/common/GetCredentialType?mkt=pt-BR' \\ --header 'Content-Type: application/json' \\ --header 'Cookie: fpc=Avu1jfhsb2hEhMRueZ1yZ9Q; stsservicecookie=estsfd; x-ms-gateway-slice=estsfd' \\ --data-raw '{ \"username\": \"abacate@avocado.com.br\" }' Regardless of which format you use above, both will return the following structure: { \"Username\": \"\", \"Display\": \"\", \"IfExistsResult\": 0, \"IsUnmanaged\": false, \"ThrottleStatus\": 0, \"Credentials\": {}, \"DfpProperties\": {}, \"EstsProperties\": {}, \"IsSignupDisallowed\": false, \"apiCanary\": \"\" } The IfExistisResult and ThrottleStatus fields respectively determine if the user exists and the resource status. This assertion is possible through the following behavioral observation: If user and domain do not exist, IfExistisResult and ThrottleStatus will be 1; If user does not exist but the domain exists, IfExistisResult will be 1 and ThrottleStatus will be 0; If user and domain exist, IfExistisResult and ThrottleStatus will be 0; Thus, we confirm for the second time that it is possible to identify users through the service. Note: There are other changes in the json that assist in identification but have been omitted for brevity. Expanded Methodology Considering that the Azure DevOps service also uses Microsoft Online, and its URL is accessible via https://dev.azure.com/{organizationName}, it is possible to scale the discovery through web scraping on a social network like LinkedIn to obtain the primary name of each company. With the list ready, automate the discovery until you get an HttpStatus 200: https://dev.azure.com/mcdonalds https://dev.azure.com/samsung https://dev.azure.com/ibm https://dev.azure.com/suaempresa ... https://dev.azure.com/microsoft Once the target is defined, simply apply any of the methodologies described in this document: User does not exist in the domain User exists and is prompted for a password In addition to obvious names as demonstrated above (admin, infra, hr, contact...), we can perform another web scraping on LinkedIn, this time focusing on employees of the target company. From names and surnames, generate all combinations (including hyphens, underscores, or periods) using tools like Crunch. With the data set ready, let brute force do the rest using software like John the Ripper, Hydra, or Hashcat. Users who do not have a second factor of security and use weak passwords will inevitably be subject to having their credentials compromised. Impact This seemingly harmless information can significantly impact the organization's security, as the exposure of access credentials contributes to the increase and effectiveness of subsequent attacks, such as phishing, social engineering, and brute force. Phishing An attack that seeks to steal your money or identity by tricking you into revealing personal information, such as credit card numbers, banking details, or passwords on sites that pretend to be legitimate. Cybercriminals often impersonate trusted companies, friends, or acquaintances in a fake email message that contains a link to a phishing site. (Source: Microsoft Support). A subset of this practice is spear phishing, which involves the specialization of the attack where attackers conduct extensive research on the intended targets. This high level of personalization aims at specific individuals or companies, leading to financial fraud, stock price manipulation, espionage, or theft of confidential data for resale. It may also be designed to infect devices with malware. (Source: Kaspersky Resource Center) Social Engineering Social engineering attacks manipulate people's emotions and instincts in ways that reliably lead them to share information they shouldn't, download software they shouldn't, visit sites they shouldn't, send money to criminals, or make other mistakes that compromise their personal or organizational security. (Source: IBM Think). In addition to the aforementioned phishing and spear phishing, there are other types of social engineering attacks, including baiting (tricking by curiosity), tailgating (piggybacking on an unlocked device), pretexting (the false digital samaritan), quid pro quo (desirable but false services in exchange for information), scareware (manipulation through fear), and watering hole (infecting a real service). Brute Force A brute force attack uses a trial-and-error method to guess login information or encryption keys. Attackers work through all possible combinations in hopes of hitting the correct one. (Source: Kaspersky Resource Center) A subtype of this type of attack is known as Password Spraying, which involves exhaustively attempting to use the same password across multiple accounts before trying another one. Password spraying attacks tend to be effective because many users not only reuse the same passwords across different services but also often use simple, easily guessable passwords. (Source: Kaspersky Resource Center) Although it may seem like searching for a \"needle in a haystack,\" advancements in artificial intelligence (AI) and large language models (LLMs) optimize, accelerate, and scale attacks, bypassing captchas and adjusting attack frequency without human intervention. The only place where human factors come into play is in password creation. The table below highlights the most commonly used passwords in United States in 2023: Posi√ß√£o Senha Ocorr√™ncias 1¬∫ 123456 83.429 2¬∫ password 44.484 3¬∫ admin 39.940 4¬∫ 102030 28.034 5¬∫ UNKNOWN 14.564 7¬∫ 123456789 13.173 9¬∫ abc123 8360 11¬∫ Password1 5243 14¬∫ 1q2w3e4r 4364 16¬∫ shitbird 4230 Source: Nordpass You can see more details about how quickly a password can be discovered in this article from Hive Systems. Mitigation To mitigate the user enumeration vulnerability, it's essential to implement robust security measures that make exploitation more difficult, such as: Standardizing Error Messages: Ensure that all error messages during the authentication process are uniform and do not provide hints about the validity of usernames. The same applies to response times of requests. Login Attempt Limits: Implement a policy to limit authentication attempts. After a predefined number of failed attempts, temporarily block the account or require a waiting period. Access Monitoring and Logging: Configure monitoring and auditing for all authentication attempts. Regularly review these logs to identify patterns of enumeration attacks. Use of CAPTCHAs: Add CAPTCHAs to the authentication process to hinder the automation of enumeration attacks. Tamper-Resistance Checks: Implement robust checks to ensure that requests cannot be exploited for tampering. Relevance Robust access control policies, such as multi-factor authentication or zero trust, limit access for cybercriminals. However, the lack of uniform responses during access opens the door to user enumeration vulnerabilities, which are recognized risks by various security organizations. OWASP (Open Web Application Security Project): Frequently mentioned in the OWASP Top 10 and cited in the Authentication Cheat Sheet, it is also present in the categories: A1:2021 - Broken Access Control; A7:2021 - Identification and Authentication Failures; A9:2017 - Using Components with Known Vulnerabilities. NIST (National Institute of Standards and Technology): The practice is addressed in NIST SP 800-63B: Digital Identity Guidelines, topic 8: \"Threats and Security Considerations\". ISO (International Organization for Standardization): Although it does not specifically mention user enumeration, the security guidelines of ISO/IEC 27001 and ISO/IEC 27034 emphasize the importance of protecting authentication information and adopting secure development practices. SEI CERT (Software Engineering Institute CERT): The SEI CERT Coding Standards provide 10 secure coding practices to avoid various vulnerabilities. Notably, item 8: \"Practice defense in depth\" emphasizes ensuring multiple layers of protection by combining techniques to reduce security gaps. CVE (Common Vulnerabilities and Exposures): In addition to its base definition CWE-200: Exposure of Sensitive Information to an Unauthorized Actor, many well-known services and software, such as WordPress, OpenSSH, and GitLab, have been marked. Multiple user enumeration entries are regularly cataloged in the CVE database. NVD (National Vulnerability Database): Enriches a CVE and expands details with technical references, impact analysis, remediation guidance, and risk ratings (CVSS). Report The discovery was properly reported to the Microsoft Security Response Center (MSRC) through the Microsoft Bug Bounty Program, following responsible disclosure guidelines in accordance with ISO/IEC 29147:2018 and the CERT Guide to Coordinated Vulnerability Disclosure, aiming to ensure proper mitigation and protection of potentially affected users. Since the event was not deemed a vulnerability, I am making the scenario public to align understanding on the contexts where the vulnerability mentioned here should be considered a risk. Identification Identifier: microsoft_bounty_1¬π (external tracking ID) Category: User Enumeration Severity: 8.8/High CVSS: CVSS:4.0/AV:N/AC:L/AT:N/PR:N/UI:N/VC:H/VI:L/VA:N/SC:N/SI:N/SA:N ¬π Since the item was not considered a threat (even though it was reported twice), no CVE code was assigned. Timeline Date of Discovery: April 26, 2024 Date of Notification to MSRC: April 27, 2024 Date of Analysis by MSRC: June 29, 2024 Date of Conclusion by MSRC: June 12, 2024 Response Received MSRC Email communication 12 de jun. de 2024, 22:31 Subject: RE: MSRC Case microsoft_bounty_1 Hello Raphael, Thank you for submitting this issue to Microsoft. We appreciate the time taken to submit this report. Upon investigation, we have determined that this is not considered a security vulnerability for servicing. Please refer https://learn.microsoft.com/en-us/entra/fundamentals/users-default-permissions#restrict-member-users-default-permissions As such this case is now closed. Thank you for working with us and we look forward to more reports from you in the future! Warm regards, MSRC The referred link discusses access permissions between authenticated users and guests, with the intent of restricting access. However, it does not apply to the issue demonstrated in this document, as the vulnerability can be exploited freely. To that end, I sent a second report on 08/09/2024 at 02:05PM, demonstrating how to automate the discovery process. However, the response I received was: MSRC Email communication 22 de ago. de 2024, 09:16 Subject: RE: MSRC microsoft_bounty_2 Hello Thank you for reporting this to Microsoft. Upon investigation, we have determined that this issue does not constitute a security vulnerability that meets our bar, since this information is necessary for customized login interfaces intending to use custom domain/login experience, and this information poses limited risk to confidentiality, integrity or availability of a user or the service. However, we have informed the team about this issue and they will continually assess the security of the service to keep our customers protected. As such, we are closing this case. If you have any questions or concerns, please feel free to reach out. Regards MSRC In other words, the possibility of user and domain enumeration was not considered a vulnerability, as the behavior is \"expected,\" since it is characterized as a \"standard applicable to the custom interface resource.\" Therefore, the information obtained through its exploitation presents a \"limited risk.\" Conclusion The discovery of this vulnerability in Microsoft Online's authentication service highlights the ongoing importance of security reviews and compliance with international standards. However, the failure to recognize it as a flaw raises the question of when a vulnerability should be treated as a risk. Security companies that conduct penetration testing, such as Tracker, Desec, HackerSec, Ravel, Kaspersky, Tempest, e-Security, Vantico, or Tivit, follow industry standards, and therefore, Microsoft Online's authentication should also be subject to the same scrutiny. If the vulnerability of user and domain enumeration is not applicable in this context, justified by the need for a \"custom interface\", what is the threshold that separates a proprietary authentication mechanism from an external provider when the same penetration test reveals a critical failure in one and overlooks it in the other? References ISO/IEC 27034-1:2011 - Application security; CERT Guide to Coordinated Vulnerability Disclosure; NVD (National Vulnerability Database); CVSS (Common Vulnerability Scoring System) Calculator; OWASP Authentication Cheat Sheet; NIST Special Publication 800-63B;"
  },
  "aegis/divulgacao/microsoft/vulnerabilidade-enumeracao-usuarios-loginmicrosoftonline.html": {
    "href": "aegis/divulgacao/microsoft/vulnerabilidade-enumeracao-usuarios-loginmicrosoftonline.html",
    "title": "Divulga√ß√£o de Vulnerabilidade: Enumera√ß√£o de Usu√°rios no Servi√ßo de Autentica√ß√£o Microsoft Online | por Raphael Moreira",
    "keywords": "Divulga√ß√£o de Vulnerabilidade: Enumera√ß√£o de Usu√°rios no Servi√ßo de Autentica√ß√£o Microsoft Online Data da publica√ß√£o: 05/11/2024 17:35 üáßüá∑ | üá∫üá∏ Introdu√ß√£o Este documento visa descrever a vulnerabilidade de enumera√ß√£o de usu√°rios descoberta na autentica√ß√£o do Microsoft Online, passivo de explora√ß√£o de forma visual e program√°tica, em qualquer aplica√ß√£o que se integre ao servi√ßo. Explora√ß√£o O vetor de ataque prov√©m tanto da observa√ß√£o do comportamento das mensagens de retorno (visual), quanto pela estrutura de resposta do endpoint respectivo (program√°tico). Requisitos Embora a vulnerabilidade esteja no servi√ßo de autentica√ß√£o do Microsoft Online, os passos a seguir visam a explora√ß√£o de forma breve, em ambiente controlado e seguro, simulando a integra√ß√£o de uma aplica√ß√£o fict√≠cia denominada minha-app.com: Acesse o portal Azure AD (Microsoft Entra ID) e registre uma nova aplica√ß√£o atrav√©s do App Registration; Escolha o m√©todo Access Token; Conceda as permiss√µes email e User.Read por meio do Microsoft Graph. Ap√≥s o registro, obtemos - dentre outros valores omitidos por brevidade - o par√¢metro appId, usado na constru√ß√£o da url que redirecionar√° de, minha-app.com para login.microsofonline.com, onde a autentica√ß√£o ocorrer√°: https://login.microsoftonline.com/{appId}/oauth2/v2.0/authorize Devemos incluir tamb√©m os par√¢metros clientId e code, obtidos durante o fluxo do backend da minha-app.com: ?client_id={clientId}&response_type=code&code_challenge={code} Por fim, completamos com os par√¢metros fixos: &code_challenge_method=S256 &redirect_uri=https://minha-app.com/successo &scope=https://graph.microsoft.com/email &prompt=select_account &sso_reload=true No conjunto final, a url a ser usada pela minha-app.com ser√°: https://login.microsoftonline.com/{appId}/oauth2/v2.0/authorize?client_id={clientId}&response_type=code&code_challenge={code}&code_challenge_method=S256&redirect_uri=https://minha-app.com/success&scope=https://graph.microsoft.com/email&prompt=select_account&sso_reload=true Metodologia Visual A url ir√° te levar at√© o servi√ßo de autentica√ß√£o da aplica√ß√£o (appId), personalizado para o inquilino solicitante (clientId), o qual exigir√° as credenciais de acesso. A partir da an√°lise no padr√£o de resposta, √© poss√≠vel determinar se o usu√°rio existe ou n√£o. Tela inicial Informo dados inv√°lidos Servi√ßo confirma Dom√≠nio correto, a mensagem muda Usu√°rio correto, √© solicitado a senha Metodologia Program√°tica Inspecionando o c√≥digo-fonte do servi√ßo login.microsoftonline.com, e analisando os pacotes enviados pela rede, encontramos o endpoint GetCredentialType. Ao extrair o corpo da requisi√ß√£o, obtemos: curl --location 'https://login.microsoftonline.com/common/GetCredentialType?mkt=pt-BR' \\ --header 'accept: application/json' \\ --header 'accept-language: pt-BR,pt;q=0.7' \\ --header 'canary: {canaryHash}' \\ --header 'client-request-id: {requestGuid}' \\ --header 'content-type: application/json; charset=UTF-8' \\ --header 'cookie: brcap=0; ESTSSSOTILES=1; AADSSOTILES=1; x-ms-gateway-slice=estsfd; stsservicecookie=estsfd; AADSSO=NA|NoExtension; ESTSAUTHLIGHT=+58498593-a7a2-422b-84bd-ef0fb1c85b0d; CCState={cstateHash}' \\ --header 'hpgact: 1800' \\ --header 'hpgid: 1104' \\ --header 'hpgrequestid: {hpgRequestGuid}' \\ --header 'origin: https://login.microsoftonline.com' \\ --header 'priority: u=1, i' \\ --header 'referer: https://login.microsoftonline.com/{appId}/oauth2/v2.0/authorize?client_id={clientId}&response_type=code&code_challenge={code}&code_challenge_method=S256&redirect_uri=https://minha-app.com/successo&scope=https://graph.microsoft.com/email&prompt=select_account&sso_reload=true --header 'sec-ch-ua: \"Brave\";v=\"125\", \"Chromium\";v=\"125\", \"Not.A/Brand\";v=\"24\"' \\ --header 'sec-ch-ua-mobile: ?0' \\ --header 'sec-ch-ua-platform: \"Windows\"' \\ --header 'sec-fetch-dest: empty' \\ --header 'sec-fetch-mode: cors' \\ --header 'sec-fetch-site: same-origin' \\ --header 'sec-gpc: 1' \\ --header 'user-agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/125.0.0.0 Safari/537.36' \\ --data-raw '{\"username\":\"abacate@avocado.com.br\",\"isOtherIdpSupported\":true,\"checkPhones\":false,\"isRemoteNGCSupported\":true,\"isCookieBannerShown\":false,\"isFidoSupported\":true,\"originalRequest\":\"{originalRequestHash}\",\"country\":\"BR\",\"forceotclogin\":false,\"isExternalFederationDisallowed\":false,\"isRemoteConnectSupported\":false,\"federationFlags\":0,\"isSignup\":false,\"flowToken\":\"{flowToken}\",\"isAccessPassSupported\":true}' Embora o conjunto de cabe√ßalhos e par√¢metros sejam elevados, sugerindo tratamento seguro quanto ao envio ou origem, nada √© de fato feito com requestGuid, cstateHash, hpgRequestGuid, originalRequestHash ou flowToken. Considerando que n√£o h√° verifica√ß√£o ou consist√™ncia do objeto, quanto a sua manipula√ß√£o, podemos remov√™-los: curl --location 'https://login.microsoftonline.com/common/GetCredentialType?mkt=pt-BR' \\ --header 'Content-Type: application/json' \\ --header 'Cookie: fpc=Avu1jfhsb2hEhMRueZ1yZ9Q; stsservicecookie=estsfd; x-ms-gateway-slice=estsfd' \\ --data-raw '{ \"username\": \"abacate@avocado.com.br\" }' Independente de qual formato seja usado, ambos ir√£o retornar a seguinte estrutura: { \"Username\": \"\", \"Display\": \"\", \"IfExistsResult\": 0, \"IsUnmanaged\": false, \"ThrottleStatus\": 0, \"Credentials\": {}, \"DfpProperties\": {}, \"EstsProperties\": {}, \"IsSignupDisallowed\": false, \"apiCanary\": \"\" } Os campos IfExistisResult e ThrottleStatus determinam respectivamente a exist√™ncia do usu√°rio e o estado do recurso. Essa afirma√ß√£o √© poss√≠vel por meio da seguinte observa√ß√£o de comportamento: Se usu√°rio e dom√≠nio n√£o existem, IfExistisResult e ThrottleStatus ser√£o 1; Se usu√°rio n√£o existir, mas o dom√≠nio existir, IfExistisResult ser√° 1 e ThrottleStatus ser√° 0; Se usu√°rio e dom√≠nio existem, IfExistisResult e ThrottleStatus ser√£o 0; Com isso, verificamos pela segunda vez que √© poss√≠vel identificar usu√°rios atrav√©s do servi√ßo. Obs: h√° outras mudan√ßas no json que colaboram com a identifica√ß√£o, mas foram otimidas por brevidade. Metodologia Expandida Considerando que o servi√ßo Azure DevOps tamb√©m usa o Microsoft Online, e sua url √© acess√≠vel atrav√©s de https://dev.azure.com/{nomeDaOrganizacao}, √© poss√≠vel escalar a descoberta por meio de um web scrapping numa rede social, como o LinkedIn, a fim de obter o nome principal de cada empresa. Com a lista pronta, automatiza-se a descoberta at√© obter um HttpStatus 200: https://dev.azure.com/mcdonalds https://dev.azure.com/samsung https://dev.azure.com/ibm https://dev.azure.com/suaempresa ... https://dev.azure.com/microsoft Definido o alvo, basta aplicar qualquer uma das metodologias descritas neste documento: Usu√°rio n√£o existe no dom√≠nio Usu√°rio existe e me √© solicitado a senha Al√©m de nomes √≥bvios como o demonstrado acima (admin, infra, rh, contato...), podemos fazer outro web scrapping no LinkedIn, desta vez focado nos funcion√°rios da empresa alvo. A partir de nomes e sobrenomes, geramos todas as combina√ß√µes (incluindo h√≠fen, underscore ou ponto) atrav√©s de ferramentas como o Crunch. Com a massa de dados pronta, deixamos a for√ßa bruta fazer o resto por meio de softwares como John the Ripper, Hydra ou Hashcat. O usu√°rio que n√£o tiver um 2¬∫ fator de seguran√ßa, e faz uso de senha fraca, fatalmente estar√° sujeito a ter sua credencial quebrada. Impacto Esta informa√ß√£o, aparentemente inofensiva, pode afetar de forma significativa a seguran√ßa da organiza√ß√£o, j√° que a exposi√ß√£o de credenciais de acesso contribuem para o aumento e efic√°cia de ataques subsequentes, como phishing, engenharia social e for√ßa bruta. Phishing Ataque que tenta roubar seu dinheiro ou a sua identidade fazendo com que voc√™ revele informa√ß√µes pessoais, tais como n√∫meros de cart√£o de cr√©dito, informa√ß√µes banc√°rias ou senhas em sites que fingem ser leg√≠timos. Criminosos cibern√©ticos normalmente fingem ser empresas confi√°veis, amigos ou pessoas conhecidas em uma mensagem de email falsa, que cont√©m um link para um site de \"phishing\" (pescar). (Fonte: Suporte Microsoft). Um subconjunto dessa pr√°tica √© o spear phishing (pescar com lan√ßa), que trata da especializa√ß√£o do ataque, onde os invasores realizam pesquisas extensas sobre os alvos pretendidos. Essa alta personaliza√ß√£o visa n√£o s√≥ indiv√≠duos, como empresas espec√≠ficas, ocasionando fraudes financeiras, manipula√ß√£o de pre√ßos de a√ß√µes, espionagem ou roubo de dados confidenciais para revenda. Podem ser projetados tamb√©m para infectar dispositivos com malware. (Fonte: Kaspersky Resource Center) Engenharia Social Os ataques de engenharia social manipulam as emo√ß√µes e os instintos das pessoas de maneiras que comprovadamente a levam a compartilhar informa√ß√µes que n√£o deveriam compartilhar, baixar software que n√£o deveriam baixar, visitar sites que n√£o deveriam visitar, enviar dinheiro para criminosos ou cometer outros erros que comprometam sua seguran√ßa pessoal ou organizacional. (Fonte: IBM Think). Al√©m dos j√° citados phishing e spear phishing, temos o baiting (iscar pela curiosidade), tailgating (carona no dispositivo desbloqueado), pretexting (o falso samaritano digital), Quid pro quo (servi√ßos desej√°veis, por√©m falsos, em troca da informa√ß√£o), scareware (manipular pelo medo) e watering hole (um servi√ßo real √© infectado). For√ßa bruta Um ataque de for√ßa bruta usa o m√©todo de tentativa e erro para adivinhar informa√ß√µes de login ou chaves de criptografia. Invasores trabalham com todas as combina√ß√µes poss√≠veis na esperan√ßa de acertar.(Fonte: Kaspersky Resource Center) Um subtipo dessa forma de ataque √© conhecido como Password Spraying (pulveriza√ß√£o de senhas), que consiste na tentativa exaustiva de usar a mesma senha em diversas contas antes de tentar outra. Ataques de pulveriza√ß√£o de senhas costumam ser efetivos, porque muitos usu√°rios, al√©m de usarem as mesmas senhas em diferentes servi√ßos, em geral s√£o de simples memoriza√ß√£o e f√°ceis de adivinhar. [Fonte: Kaspersky Resource Center] Embora pare√ßa como procurar \"agulha num palheiro\", o avan√ßo da intelig√™ncia artificial (IA) e modelos de linguagem de larga escala (LLM) otimizam, aceleram, escalam, d√£o bypass em captcha e ajustam frequ√™ncia no ataque sem necessidade do fator humano. O √∫nico local onde h√° o fator humano, √© na concep√ß√£o de senha. O quadro abaixo destaca as mais utilizadas no Brasil, no ano de 2023: Posi√ß√£o Senha Ocorr√™ncias 1¬∫ admin 204.846 2¬∫ 123456 137.551 3¬∫ 12345678 46.666 4¬∫ 102030 28.034 5¬∫ 123456789 24.834 7¬∫ gvt12345 10.684 9¬∫ password 8687 11¬∫ 123mudar 8202 15¬∫ fera@123 6364 20¬∫ Senha 4762 Fonte: Nordpass Voc√™ pode ver maiores detalhes sobre o qu√£o r√°pido uma senha pode ser descoberta, neste artigo do Hive System. Mitiga√ß√£o Para mitigar a vulnerabilidade de enumera√ß√£o de usu√°rios, √© essencial implementar medidas de seguran√ßa robustas que dificultem sua explora√ß√£o, como: Uniformiza√ß√£o das mensagens de erro: assegurar que todas as mensagens de erro durante o processo de autentica√ß√£o sejam uniformes, n√£o fornecendo pistas sobre a validade dos nomes de usu√°rios. O mesmo vale para tempo de resposta da requisi√ß√£o. Limita√ß√£o de tentativas de login: implemente uma pol√≠tica de limita√ß√£o de tentativas de autentica√ß√£o. Ap√≥s um n√∫mero predefinido de tentativas falhas, bloqueie temporariamente a conta ou exija um tempo de espera. Monitoramento e log de acessos: configure o monitoramento e auditoria de todas as tentativas de autentica√ß√£o. Analise esses logs regularmente para identificar padr√µes de ataques de enumera√ß√£o. Utiliza√ß√£o de captchas: adicione CAPTCHAs no processo de autentica√ß√£o para dificultar a automa√ß√£o de ataques de enumera√ß√£o. Verifica√ß√µes contra adultera√ß√£o: avalia√ß√µes robustas na requisi√ß√£o devem garantir que o evento n√£o possa ser explorado. Relev√¢ncia Pol√≠ticas robustas de controle de acesso, como multifator ou zero trust, limitam o acesso dos cibercriminosos, mas a falta de respostas uniformes durante este acesso, abre caminho para a vulnerabilidade de enumera√ß√£o de usu√°rios, cujo risco √© reconhecido por v√°rias organiza√ß√µes de seguran√ßa. OWASP (Open Web Application Security Project): frequentemente mencionada no OWASP Top 10 e citado nas diretrizes do Authentication Cheat Sheet, est√° presente tamb√©m nas categorias: A1:2021 - Broken Access Control; A7:2021 - Identification and Authentication Failures; A9:2017 - Using Components with Known Vulnerabilities. NIST (National Institute of Standards and Technology): a pr√°tica √© abordada pelo NIST SP 800-63B: Digital Identity Guidelines, t√≥pico 8: \"Threats and Security Considerations\". ISO (International Organization for Standardization): embora n√£o mencione especificamente a enumera√ß√£o de usu√°rios, as diretrizes de seguran√ßa da ISO/IEC 27001 e ISO/IEC 27034 ressaltam, respectivamente, a import√¢ncia de proteger informa√ß√µes de autentica√ß√£o e ado√ß√£o de pr√°ticas seguras de desenvolvimento. SEI CERT (Software Engineering Institute CERT): o SEI CERT Coding Standards fornece 10 pr√°ticas de codifica√ß√£o segura para evitar diversas vulnerabilidades. Dentre elas, podemos destacar o item 8: \"Practice defense in depth\", cuja orienta√ß√£o √© assegurar mais de uma camada de prote√ß√£o, combinando t√©cnicas para reduzir as lacunas de seguran√ßa. CVE (Common Vulnerabilities and Exposures): al√©m de sua defini√ß√£o base CWE-200: Exposure of Sensitive Information to an Unauthorized Actor, muitos servi√ßos e softwares conhecidos, como WordPress, OpenSSH e GitLab j√° marcaram presen√ßa. M√∫ltiplas entradas de enumera√ß√£o de usu√°rios s√£o regularmente catalogadas no banco de dados da CVE. NVD (National Vulnerability Database): enriquece uma CVE e expande detalhes com refer√™ncias t√©cnicas, an√°lise de impacto, orienta√ß√µes de remedia√ß√£o e classifica√ß√µes de risco (CVSS). Relato A descoberta foi devidamente relatada ao Microsoft Security Response Center (MSRC), via Microsoft Bug Bounty Program, seguindo as diretrizes de divulga√ß√£o respons√°vel em conformidade com as diretrizes da ISO/IEC 29147:2018 e do CERT Guide to Coordinated Vulnerability Disclosure, visando garantir a mitiga√ß√£o adequada e a prote√ß√£o de poss√≠veis usu√°rios afetados. Dado que o evento n√£o foi considerado uma vulnerabilidade, torno p√∫blico o cen√°rio com o intuito de alinhar entendimento sobre quais contextos a vulnerabilidade aqui citada, deve ser considerada um risco. Identifica√ß√£o Identificador: microsoft_bounty_1¬π (external tracking ID) Categoria: Enumera√ß√£o de Usu√°rios Gravidade: 8.8/Alta CVSS: CVSS:4.0/AV:N/AC:L/AT:N/PR:N/UI:N/VC:H/VI:L/VA:N/SC:N/SI:N/SA:N ¬π dado que o item n√£o foi considerado uma amea√ßa (mesmo tendo sido comunicado 2 vezes), nenhum c√≥digo CVE foi atribu√≠do. Linha do Tempo Data da descoberta: 26 de Abril de 2024 Data da notifica√ß√£o ao MSRC: 27 de Abril de 2024 Data da an√°lise pelo MSRC: 29 de Junho de 2024 Data da conclus√£o pelo MSRC: 12 de Junho de 2024 Resposta Obtida MSRC Email communication 12 de jun. de 2024, 22:31 Subject: RE: MSRC Case microsoft_bounty_1 Hello Raphael, Thank you for submitting this issue to Microsoft. We appreciate the time taken to submit this report. Upon investigation, we have determined that this is not considered a security vulnerability for servicing. Please refer https://learn.microsoft.com/en-us/entra/fundamentals/users-default-permissions#restrict-member-users-default-permissions As such this case is now closed. Thank you for working with us and we look forward to more reports from you in the future! Warm regards, MSRC O link referido fala sobre permiss√µes de acesso entre usu√°rios autenticados e visitantes, com o intuito de restri√ß√£o. Contudo, n√£o se aplica ao que foi demonstrado neste documento, uma vez que √© poss√≠vel explorar a vulnerabilidade livremente. Para tal, enviei um segundo relato, em 09/08/2024, √†s 14:05, demonstrando como automatizar o processo de descoberta. Contudo, a resposta obtida foi: MSRC Email communication 22 de ago. de 2024, 09:16 Subject: RE: MSRC microsoft_bounty_2 Hello Thank you for reporting this to Microsoft. Upon investigation, we have determined that this issue does not constitute a security vulnerability that meets our bar, since this information is necessary for customized login interfaces intending to use custom domain/login experience, and this information poses limited risk to confidentiality, integrity or availability of a user or the service. However, we have informed the team about this issue and they will continually assess the security of the service to keep our customers protected. As such, we are closing this case. If you have any questions or concerns, please feel free to reach out. Regards MSRC Em outras palavras, a possibilidade de enumera√ß√£o de usu√°rios e dom√≠nios n√£o foi considerada uma vulnerabilidade, pois o comportamento \"√© esperado\", j√° que se caracteriza como um \"padr√£o aplic√°vel ao recurso de interface personalizada\", portanto, a informa√ß√£o obtida atrav√©s de sua explora√ß√£o, apresenta um \"risco limitado\". Conclus√£o A descoberta desta vulnerabilidade no servi√ßo de autentica√ß√£o do Microsoft Online ressalta a import√¢ncia cont√≠nua de revis√µes de seguran√ßa e conformidade com padr√µes internacionais. No entanto, ao n√£o considerar uma falha, levanta-se a quest√£o sobre quando a vulnerabilidade deve ser tratada como um risco ou n√£o. Empresas de seguran√ßa, que aplicam testes de penetra√ß√£o, como Tracker, Desec, HackerSec, Ravel, Kaspersky, Tempest, e-Security, Vantico ou Tivit, guiam-se pelos padr√µes de mercado, logo, a autentica√ß√£o Microsoft Online tamb√©m deveria estar sujeito ao mesmo. Se a vulnerabilidade de enumera√ß√£o de usu√°rios e dom√≠nios n√£o √© aplic√°vel neste contexto, justificado pela necessidade de uma \"interface personalizada\", qual √© o limiar que separa um mecanismo pr√≥prio de autentica√ß√£o, de um provedor externo, quando o mesmo teste de penetra√ß√£o acusa falha cr√≠tica em um, e passa pano na outra? Refer√™ncias ISO/IEC 27034-1:2011 - Application security; CERT Guide to Coordinated Vulnerability Disclosure; NVD (National Vulnerability Database); CVSS (Common Vulnerability Scoring System) Calculator; OWASP Authentication Cheat Sheet; NIST Special Publication 800-63B;"
  },
  "aegis/intro.html": {
    "href": "aegis/intro.html",
    "title": "Introdu√ß√£o | por Raphael Moreira",
    "keywords": "Introdu√ß√£o √â crucial adotar uma abordagem abrangente e estruturada que garanta a seguran√ßa das aplica√ß√µes web, por isso, este conte√∫do √© apoiado por recursos como CERT, ISC, CVE, NVD, NIST, ISO, OWASP e pr√°ticas de Pentest, visando a cria√ß√£o de um ambiente robusto e resiliente. Aqui voc√™ encontrar√° experimentos e exemplos reais (divulga√ß√µes) que levantam quest√µes sobre a quebra ou n√£o das diretrizes e melhores pr√°ticas."
  },
  "apetrechos/intro.html": {
    "href": "apetrechos/intro.html",
    "title": "Introdu√ß√£o | por Raphael Moreira",
    "keywords": "Introdu√ß√£o Sobre o projeto Apetrechos..."
  },
  "cachimonia/intro.html": {
    "href": "cachimonia/intro.html",
    "title": "Introdu√ß√£o | por Raphael Moreira",
    "keywords": "Introdu√ß√£o Sobre o projeto Cachim√¥nia..."
  },
  "index.html": {
    "href": "index.html",
    "title": "C√≥dice | por Raphael Moreira",
    "keywords": "C√≥dice Local dedicado a compartilhar assuntos geralmente pouco ortodoxos, sem periodicidade regular - filho pequeno..., sabem como √© -, mas com potencial de ajudar entusiastas da √°rea. Disponibilizado em categorias e publicado em cap√≠tulos, o C√≥dice √© um antro de informa√ß√£o que responde perguntas a qual ningu√©m fez. Categorias dispon√≠veis √Ügis Contato Plataforma Url LinkedIn https://www.linkedin.com/in/raphaelmoreira/ GitHub https://github.com/raphaelmoreira OWASP (Slack) https://app.slack.com/client/T04T40NHX/D07RRK18BPH 2024¬©"
  },
  "singularidade/ia-indiscutivel-arte.html": {
    "href": "singularidade/ia-indiscutivel-arte.html",
    "title": "I.A - (In)discut√≠vel Arte | por Raphael Moreira",
    "keywords": "I.A - (In)discut√≠vel Arte Apesar do t√≠tulo sugestivo, n√£o vou entrar na cl√°ssica discuss√£o sobre \"o que √© arte\". Esse √© um debate t√£o subjetivo que poderia nos levar a um labirinto sem sa√≠da. Meu objetivo aqui √© mais simples: quero contar a hist√≥ria de dois camaradas. Hotpot.AI Meu primeiro contato com esse tipo de ferramenta foi com o simp√°tico Hotpot. Ele oferece uma infinidade de aplica√ß√µes, desde ideias textuais (como sugest√µes de roteiros, livros, nomes para produtos, personagens, ideias gerais...) at√© artes visuais (edi√ß√£o de fotos, desenhos estilizados, NFTs...). Cada a√ß√£o solicitada consome uma quantidade de cr√©ditos proporcional √† complexidade. Quase todas exigem cr√©ditos (ou seja, s√£o pagas), mas h√° duas exce√ß√µes gratuitas e interessantes. A primeira √© o Art Maker, que, como o nome sugere, faz... macarr√£o com queijo! Minto. Ele s√≥ cria arte a partir do que voc√™ digita: \"A dog with wings\" Eu sei o que voc√™ est√° pensando: \"Nossa, que porcaria. Nada a ver.\" Mas, olha s√≥, uma descri√ß√£o meia boca vai te dar um resultado p√© de chinelo. Ent√£o, √© fundamental estruturar bem suas frases; caso contr√°rio, sua intera√ß√£o com a ferramenta vai ser como tentar conversar com a velha surda. A segunda modalidade √© o AI Sparkwriter (art idea), que promete ser a fa√≠sca criativa, gerando 5 frases sobre o assunto (desde que voc√™ use pelo menos 5 palavras). Vamos ver como funciona... \"a dog with chicken wings\" Das 5 respostas que obtivemos, concentre-se na de n√∫mero 2: With his giant wings, the dog eats the chicken and flies away. The dog is tired of people trying to pet him so he eats the chicken, gains wings and fly away. A close up of a chicken wing attached to a dog bone. A hound with a full chicken wing for his meal. The idea of eating chicken wings makes this dog too heavy, he jumps off his dining chair before it breaks. Vamos ser honestos: a segunda op√ß√£o tem seu valor. Convenhamos que voc√™ n√£o teria pensado nessas ideias, teria? Nem mesmo sob entorpecentes pesados! Ah, e vale mencionar que se voc√™, por algum motivo, conseguir dar um n√≥ na I.A, isto √©, faz√™-la pensar por mais de 2 horas sem gerar um resultado, o dono do site te d√° 200 cr√©ditos para usar nos servi√ßos pagos (Oi, Clarence!). Fiz meu p√© de meia! =D Midjourney Nessa minha segunda tentativa de transformar minhas ideias catacl√≠smicas e n√£o ortodoxas em realidade, o Midjourney se destacou com resultados surpreendentemente satisfat√≥rios. Pelo Discord, voc√™ pode bombardear a I.A. com requisi√ß√µes megaloman√≠acas. Mesmo que n√£o saia exatamente como voc√™ imaginou, a arte final vai te agradar. Vamos tentar de novo: \"A dog with wings\" Em 1 minuto, ele te entrega 4 sugest√µes, que voc√™ pode variar ou recome√ßar sem mudar a instru√ß√£o principal (prompt). Quando estiver satisfeito, √© s√≥ pedir a vers√£o em alta defini√ß√£o. Simples assim. No site oficial, voc√™ encontra todas as keywords para refinar os resultados, mas confesso que voc√™ aprende muito vendo a arte dos outros usu√°rios. Quer um exemplo? \"A dog with wings, da vinci\" Mas, claro, n√£o existe almo√ßo gr√°tis: as primeiras 25 tentativas s√£o gratuitas, depois disso, se tornam pagas (vale cada centavo). N√£o vou mostrar minhas super cria√ß√µes aqui porque s√£o t√£o fant√°sticas que n√£o quero que sejam usadas por terceiros. Ent√£o, fica a dica: vai l√° tentar a sorte! E o Dall-E 2? Infelizmente, por ser acess√≠vel apenas por convite, n√£o tive a chance de bombarde√°-lo com minhas frases mirabolantes. Mas a capacidade dele √© de cair o queixo. Sendo assim, n√£o posso opinar. Artigo originalmente postado em 11 de Setembro de 2022 | LinkedIn"
  },
  "singularidade/intro.html": {
    "href": "singularidade/intro.html",
    "title": "Introdu√ß√£o | por Raphael Moreira",
    "keywords": "Introdu√ß√£o Desbravando as terras desoladas da exist√™ncia, sobre o que √© interessante, curioso e desnecess√°rio."
  }
}